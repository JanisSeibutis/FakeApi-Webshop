import{r as l,j as t,c as p}from"./index-yEnK5jrz.js";const x=l.createContext({products:[],setProducts:()=>{},filterArray:[],setFilterArray:()=>{}}),h=()=>l.useContext(x),m=({product:c})=>{const[e,s]=l.useState(0),r=()=>{e!==0&&s(e-1)},n=()=>{if(e===0)return;const o={...c,quantity:e};let i=JSON.parse(localStorage.getItem("cart"))||[],d=i.findIndex(u=>u.id===o.id);d>=0?i[d].quantity+=e:i.push(o),localStorage.setItem("cart",JSON.stringify(i)),window.dispatchEvent(new Event("storage")),s(0)};return t.jsxs("div",{className:"change-amount",children:[t.jsx("button",{className:"decrease-btn",onClick:()=>r(),children:"-"}),t.jsx("p",{className:"cart-count",children:e}),t.jsx("button",{className:"increase-btn",onClick:()=>s(e+1),children:"+"}),t.jsx("button",{className:"add-to-cart",onClick:()=>n(),children:"Add to Cart"})]})},j=({product:c,closeModal:e})=>{const{products:s}=h();return!s||s.length===0?null:t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"backdrop",onClick:e}),t.jsxs("div",{className:"modal",children:[t.jsx("img",{className:"selected-product-img",src:c.image,alt:""}),t.jsx("button",{className:"close-modal-btn",onClick:e,children:"x"}),t.jsx(m,{product:c}),t.jsx("p",{className:"selected-product-description",children:c.description}),t.jsxs("p",{className:"selected-item-price",children:[" ",c.price," €"]})]})]})},g=()=>{const{filterArray:c,products:e}=h(),[s,r]=l.useState(!1),[n,o]=l.useState(null),i=a=>{o(a),r(!0)},d=()=>{r(!1),o(null)},u=c.length>0?c:e;return e?t.jsxs("div",{className:"product-container",children:[u.map(a=>t.jsxs("div",{className:"product-div",children:[t.jsx("img",{className:"product-img",src:a.image,alt:a.title,onClick:()=>i(a)}),t.jsx(m,{product:a}),t.jsxs("p",{className:"product-title",children:[a.title," "]}),t.jsxs("p",{className:"product-title",children:[a.price," €"]})]},a.id)),s&&t.jsx(j,{product:n,closeModal:d})]}):t.jsx("p",{children:"Loading..."})},f=()=>{const{setFilterArray:c,products:e}=h(),s=r=>{const n=e.filter(o=>o.category===r);c(n)};return t.jsx("aside",{children:t.jsxs("ul",{className:"aside-list",children:[t.jsx("li",{onClick:()=>c(e),children:"All Products"}),t.jsx("li",{onClick:()=>s("men's clothing"),children:"Mens Clothing"}),t.jsx("li",{onClick:()=>s("women's clothing"),children:"Womens Clothing"}),t.jsx("li",{onClick:()=>s("jewelery"),children:"Jewelry"}),t.jsx("li",{onClick:()=>s("electronics"),children:"Electronic items"})]})})},C=()=>{const c="https://fakestoreapi.com/products",[e,s]=l.useState(()=>{const r=localStorage.getItem("cachedProducts");return r?JSON.parse(r):[]});return l.useEffect(()=>{const r=async()=>{try{const n=await fetch(c);if(n.ok){const o=await n.json();s(o),localStorage.setItem("cachedProducts",JSON.stringify(o))}else throw new Error("Failed to fetch products")}catch(n){console.error("Something went wrong",n)}};e.length===0&&r()},[c,e.length]),e},N=({children:c})=>{const[e,s]=l.useState([]),[r,n]=l.useState([]),o=C();return l.useEffect(()=>{s(o),n(e)},[]),t.jsx(x.Provider,{value:{products:e,setProducts:s,filterArray:r,setFilterArray:n},children:c})},S=p("/")({component:P});function P(){return t.jsx("div",{children:t.jsx("main",{className:"container",children:t.jsxs(N,{children:[t.jsx(f,{}),t.jsx(g,{})]})})})}export{S as Route};
